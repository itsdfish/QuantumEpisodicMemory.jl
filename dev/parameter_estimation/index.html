<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parameter Estimation · QuantumEpisodicMemory</title><meta name="title" content="Parameter Estimation · QuantumEpisodicMemory"/><meta property="og:title" content="Parameter Estimation · QuantumEpisodicMemory"/><meta property="twitter:title" content="Parameter Estimation · QuantumEpisodicMemory"/><meta name="description" content="Documentation for QuantumEpisodicMemory."/><meta property="og:description" content="Documentation for QuantumEpisodicMemory."/><meta property="twitter:description" content="Documentation for QuantumEpisodicMemory."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">QuantumEpisodicMemory</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../model_description/">Model Description</a></li><li class="is-active"><a class="tocitem" href>Parameter Estimation</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Bayesian-Parameter-Estimation"><span>Bayesian Parameter Estimation</span></a></li><li><a class="tocitem" href="#Load-Packages"><span>Load Packages</span></a></li><li><a class="tocitem" href="#Generate-Data"><span>Generate Data</span></a></li><li><a class="tocitem" href="#The-Turing-Model"><span>The Turing Model</span></a></li><li><a class="tocitem" href="#Estimate-the-Parameters"><span>Estimate the Parameters</span></a></li><li><a class="tocitem" href="#Evaluation"><span>Evaluation</span></a></li><li class="toplevel"><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../plots/">Plots</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Parameter Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parameter Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/itsdfish/QuantumEpisodicMemory.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/itsdfish/QuantumEpisodicMemory.jl/blob/main/docs/src/parameter_estimation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id><a class="docs-heading-anchor" href="#"></a><a id="-1"></a><a class="docs-heading-anchor-permalink" href="#" title="Permalink"></a></h1><p>&lt;img src=&quot;https://raw.githubusercontent.com/itsdfish/QuantumEpisodicMemory.jl/gh-pages/dev/assets/logo_readme.png&quot; alt=&quot;drawing&quot; width=&quot;900&quot;/&gt;</p><h1 id="Bayesian-Parameter-Estimation"><a class="docs-heading-anchor" href="#Bayesian-Parameter-Estimation">Bayesian Parameter Estimation</a><a id="Bayesian-Parameter-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian-Parameter-Estimation" title="Permalink"></a></h1><p>The purpose of this tutorial is to demonstrate how to perform Bayesian parameter estimation of the True and Error model (TET; Birnbaum &amp; Quispe-Torreblanca, 2018) using the <a href="https://turinglang.org/">Turing.jl</a> package. </p><h2 id="Load-Packages"><a class="docs-heading-anchor" href="#Load-Packages">Load Packages</a><a id="Load-Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Load-Packages" title="Permalink"></a></h2><p>The first step is to load the required packages. You will need to install each package in your local environment in order to run the code locally. We will also set a random number generator so that the results are reproducible.</p><pre><code class="language-julia hljs">using Pigeons
using QuantumEpisodicMemory
using Random
using Turing
using StatsPlots
Random.seed!(6522)</code></pre><h2 id="Generate-Data"><a class="docs-heading-anchor" href="#Generate-Data">Generate Data</a><a id="Generate-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-Data" title="Permalink"></a></h2><p>For a description of the decision making task, please see the description in the <a href="https://itsdfish.github.io/TrueAndErrorModels.jl/dev/overview/">model overview</a>. In the code block below, we will create a model object and generate 2 simulated responses from 100 simulated subjects for a total of 200 responses. For this model, we assume that the probability of a true preference state RR is relatively high, and the probability of other preference states decreases as they become more difference from RR:</p><ul><li><span>$p_{\mathrm{R_1R_2}} = .65$</span></li><li><span>$p_{\mathrm{R_1S_2}} = .15$</span></li><li><span>$p_{\mathrm{S_1R_2}} = .15$</span></li><li><span>$p_{\mathrm{S_1S_2}} = .05$</span></li></ul><p>In addition, our model assumes the error probabilities are constrained to be equal:</p><p><span>$\epsilon_{\mathrm{S}_1} = \epsilon_{\mathrm{S}_S} = \epsilon_{\mathrm{R}_1} =\epsilon_{\mathrm{R}_2} = .10$</span></p><pre><code class="language-julia hljs">dist = GQEM(; 
    θG = -.12,
    θN = -1.54,
    θψO = -.71,
    θψR = -.86,
    θψU = 1.26,
)
n_trials = 1000
responses = rand(dist, n_trials)
data = (n_trials, responses)</code></pre><pre><code class="language-julia hljs">table = to_table(data)</code></pre><pre><code class="language-julia hljs">4×3 Named Matrix{Int64}
condition ╲ word type │       old    related  unrelated
──────────────────────┼────────────────────────────────
gist                  │        70         63          6
verbatim              │        49         48         10
gist+verbatim         │        64         49          5
unrelated new         │        46         63         91</code></pre><p>In the output above, we see the response vector has 16 elements, which correspond to response frequencies for the 16 response patterns:</p><p><span>$\{(\mathcal{R}_1\mathcal{R}_2,\mathcal{R}_1\mathcal{R}_2),(\mathcal{R}_1\mathcal{R}_2,\mathcal{R}_1\mathcal{S}_2), \dots, (\mathcal{S}_1\mathcal{S}_2,\mathcal{S}_1\mathcal{S}_2)\},$</span></p><p>where <span>$\mathcal{R}$</span> and <span>$\mathcal{S}$</span> correspond to risky and safe options, respectively, and the subscript indexes the choice set.  </p><h2 id="The-Turing-Model"><a class="docs-heading-anchor" href="#The-Turing-Model">The Turing Model</a><a id="The-Turing-Model-1"></a><a class="docs-heading-anchor-permalink" href="#The-Turing-Model" title="Permalink"></a></h2><pre><code class="language-julia hljs">@model function model(data)
    θG ~ VonMises(0, π / 2)
    θU ~ VonMises(0, π / 2)
    θψO ~ VonMises(0, π / 2)
    θψR ~ VonMises(0, π / 2)
    θψU ~ VonMises(0, π / 2)
    data ~ GQEM(; θG, θU, θψO, θψR, θψU)
end</code></pre><h2 id="Estimate-the-Parameters"><a class="docs-heading-anchor" href="#Estimate-the-Parameters">Estimate the Parameters</a><a id="Estimate-the-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Estimate-the-Parameters" title="Permalink"></a></h2><p>Now that the Turing model has been specified, we can perform Bayesian parameter estimation with the function <code>sample</code>. We will use the No U-Turn Sampler (NUTS) to sample from the posterior distribution. The inputs into the <code>sample</code> function below are summarized as follows:</p><ol><li><code>model(data)</code>: the Turing model with data passed</li><li><code>NUTS(1000, .65)</code>: a sampler object for the No U-Turn Sampler for 1000 warmup samples.</li><li><code>MCMCThreads()</code>: instructs Turing to run each chain on a separate thread</li><li><code>n_iterations</code>: the number of iterations performed after warmup</li><li><code>n_chains</code>: the number of chains</li></ol><pre><code class="language-julia hljs"># Estimate parameters
chains = sample(model(data), NUTS(1000, .65), MCMCThreads(), 1000, 4)</code></pre><p>For ease of intepretation, we will convert the numerical indices of preference vector <span>$\mathbf{p}$</span> to more informative labeled indices. </p><pre><code class="language-julia hljs">name_map = Dict(
    &quot;p[1]&quot; =&gt; &quot;pᵣᵣ&quot;,
    &quot;p[2]&quot; =&gt; &quot;pᵣₛ&quot;,
    &quot;p[3]&quot; =&gt; &quot;pₛᵣ&quot;,
    &quot;p[4]&quot; =&gt; &quot;pₛₛ&quot;,
)
chains = replacenames(chains, name_map)</code></pre><p>The output below shows the mean, standard deviation, effective sample size, and rhat for each of the five parameters. The pannel below shows the quantiles of the marginal distributions. </p><pre><code class="language-julia hljs">Chains MCMC chain (1000×20×4 Array{Float64, 3}):

Iterations        = 1001:1:2000
Number of chains  = 4
Samples per chain = 1000
Wall duration     = 2.11 seconds
Compute duration  = 6.21 seconds
parameters        = pᵣᵣ, pᵣₛ, pₛᵣ, pₛₛ, ϵ
internals         = lp, n_steps, is_accept, acceptance_rate, log_density, hamiltonian_energy, hamiltonian_energy_error, max_hamiltonian_energy_error, tree_depth, numerical_error, step_size, nom_step_size

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ess_per_sec 
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64       Float64 

         pᵣᵣ    0.6580    0.0373    0.0005   6647.4436   3364.7026    1.0008      231.3522
         pᵣₛ    0.1378    0.0293    0.0004   6554.7555   3621.5757    1.0000      228.1264
         pₛᵣ    0.1180    0.0271    0.0004   5902.0436   2996.5486    1.0013      205.4099
         pₛₛ    0.0862    0.0230    0.0003   6936.9475   3246.1778    1.0003      241.4279
           ϵ    0.1018    0.0122    0.0002   6510.9497   3234.6554    1.0008      226.6018

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5% 
      Symbol   Float64   Float64   Float64   Float64   Float64 

         pᵣᵣ    0.5858    0.6331    0.6580    0.6833    0.7300
         pᵣₛ    0.0843    0.1172    0.1365    0.1574    0.1980
         pₛᵣ    0.0694    0.0991    0.1164    0.1362    0.1742
         pₛₛ    0.0448    0.0699    0.0847    0.1012    0.1362
           ϵ    0.0797    0.0937    0.1015    0.1095    0.1266</code></pre><h2 id="Evaluation"><a class="docs-heading-anchor" href="#Evaluation">Evaluation</a><a id="Evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Evaluation" title="Permalink"></a></h2><p>It is important to verify that the chains converged. We see that the chains converged according to <span>$\hat{r} \leq 1.05$</span>, and the trace plots below show that the chains look like &quot;hairy caterpillars&quot;, which indicates the chains did not get stuck. </p><pre><code class="language-julia hljs">post_plot = plot(chains, grid = false)
vline!(post_plot, [missing .65 missing .15 missing .15 missing .05 missing .10], color = :black, linestyle = :dash)</code></pre><p>The data-generating parameters are represented as black vertical lines in the density plots. As expected, the posterior distributions are centered near the data-generating parameters. Given that the data-generating and estimated model are the same, we would expect the posterior distributions to be near the data-generating parameters. </p><h1 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h1><p>Birnbaum, M. H., &amp; Quispe-Torreblanca, E. G. (2018). TEMAP2. R: True and error model analysis program in R. Judgment and Decision Making, 13(5), 428-440.</p><p>Lee, M. D. (2018). Bayesian methods for analyzing true-and-error models. Judgment and Decision Making, 13(6), 622-635.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../model_description/">« Model Description</a><a class="docs-footer-nextpage" href="../plots/">Plots »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Sunday 6 October 2024 20:27">Sunday 6 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
