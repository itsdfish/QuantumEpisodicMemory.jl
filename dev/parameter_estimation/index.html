<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parameter Estimation · QuantumEpisodicMemory</title><meta name="title" content="Parameter Estimation · QuantumEpisodicMemory"/><meta property="og:title" content="Parameter Estimation · QuantumEpisodicMemory"/><meta property="twitter:title" content="Parameter Estimation · QuantumEpisodicMemory"/><meta name="description" content="Documentation for QuantumEpisodicMemory."/><meta property="og:description" content="Documentation for QuantumEpisodicMemory."/><meta property="twitter:description" content="Documentation for QuantumEpisodicMemory."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="QuantumEpisodicMemory logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">QuantumEpisodicMemory</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../model_description/">Model Description</a></li><li class="is-active"><a class="tocitem" href>Parameter Estimation</a><ul class="internal"><li><a class="tocitem" href="#Load-Packages"><span>Load Packages</span></a></li><li><a class="tocitem" href="#Generate-Data"><span>Generate Data</span></a></li><li><a class="tocitem" href="#Turing-Model"><span>Turing Model</span></a></li><li><a class="tocitem" href="#Estimate-the-Parameters"><span>Estimate the Parameters</span></a></li><li><a class="tocitem" href="#Posterior-Distributions"><span>Posterior Distributions</span></a></li><li class="toplevel"><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../model_comparison/">Model Comparison</a></li><li><a class="tocitem" href="../plots/">Plots</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Parameter Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parameter Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/itsdfish/QuantumEpisodicMemory.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/itsdfish/QuantumEpisodicMemory.jl/blob/main/docs/src/parameter_estimation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><img src="https://raw.githubusercontent.com/itsdfish/QuantumEpisodicMemory.jl/refs/heads/main/docs/logo/logo_readme.png" alt="drawing" width="900"/><h1 id="Bayesian-Parameter-Estimation"><a class="docs-heading-anchor" href="#Bayesian-Parameter-Estimation">Bayesian Parameter Estimation</a><a id="Bayesian-Parameter-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Bayesian-Parameter-Estimation" title="Permalink"></a></h1><p>In this tutorial, we demonstrate how to perform Bayesian parameter estimation of the GQEM using <a href="https://github.com/Julia-Tempering/Pigeons.jl">Pigeons.jl</a> with the <a href="https://turinglang.org/">Turing.jl</a> interface.  For a description of the decision making task, please see the description in the <a href="https://itsdfish.github.io/TrueAndErrorModels.jl/dev/overview/">model overview</a>. </p><h2 id="Load-Packages"><a class="docs-heading-anchor" href="#Load-Packages">Load Packages</a><a id="Load-Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Load-Packages" title="Permalink"></a></h2><p>The first step is to load the required packages. You will need to install each package in your local environment in order to run the code locally. We will also set a random number generator so that the results are reproducible.</p><pre><code class="language-julia hljs">using Pigeons
using QuantumEpisodicMemory
using Random
using Turing
using StatsPlots
Random.seed!(3320)</code></pre><h2 id="Generate-Data"><a class="docs-heading-anchor" href="#Generate-Data">Generate Data</a><a id="Generate-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-Data" title="Permalink"></a></h2><p>In the code block below, we generate simulated data for parameter estimation. The first portion of the code block generates a <code>NamedTuple</code> of the parameters. Next, the parameters are passed to the <code>GQEM</code> model constructor. Finally, we generate responses from 100 trials per condition and combine the data inputs into a <code>Tuple</code> named data. </p><pre><code class="language-julia hljs">parms = (
    θG = -.12,
    θU = -1.54,
    θψO = -.71,
    θψR = -.86,
    θψU = 1.26,
)
dist = GQEM(; parms...)
n_trials = 100
responses = rand(dist, n_trials)
data = (n_trials, responses)</code></pre><p>To make the responses easier to interpret, we can use <code>to_table</code> to add labels to the rows and columns. The rows correspond to experimental conditions and columns correspond to word types.</p><pre><code class="language-julia hljs">table = to_table(responses)</code></pre><pre><code class="language-julia hljs">4×3 Named Matrix{Int64}
condition ╲ word type │       old    related  unrelated
──────────────────────┼────────────────────────────────
gist                  │        70         63          6
verbatim              │        49         48         10
gist+verbatim         │        64         49          5
unrelated new         │        46         63         91</code></pre><h2 id="Turing-Model"><a class="docs-heading-anchor" href="#Turing-Model">Turing Model</a><a id="Turing-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Turing-Model" title="Permalink"></a></h2><p>In the code block below, the Bayesian model is defined using the <code>@model</code> macro in Turing. The parameters inside the model function follow a Von Mises distribution, which roughly corresponds to a normal distribution on a circle (i.e., the support is <span>$[-\pi, \pi]$</span>). For each parameter the mean is set to zero, and the concentration parameter, which is inversely related to the variance, is set to a small number of <span>$.10$</span>.</p><pre><code class="language-julia hljs">@model function model(data)
    θG ~ VonMises(0, .1)
    θU ~ VonMises(0, .1)
    θψO ~ VonMises(0, .1)
    θψR ~ VonMises(0, .1)
    θψU ~ VonMises(0, .1)
    data ~ GQEM(; θG, θU, θψO, θψR, θψU)
end</code></pre><h2 id="Estimate-the-Parameters"><a class="docs-heading-anchor" href="#Estimate-the-Parameters">Estimate the Parameters</a><a id="Estimate-the-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Estimate-the-Parameters" title="Permalink"></a></h2><p>Quantum models present challenges for many MCMC samplers because they often produce multimodal posterior distributions.  Multimodal distributions can be traced back to the periodic effect of rotating state vectors or bases. As illustrated below, the marginal log likelihood of the data vacillates as <span>$\theta_U$</span> varies across its permissible range. </p><p><img src="../assets/LL_θU.png" alt/></p><details>
<summary><b>Show Code </b></summary><pre><code class="language-julia hljs">θUs = range(-π, π, length = 300)
LLs = map(θU -&gt; logpdf(GQEM(; parms..., θU), n_trials, responses), θUs)
plot(θUs, LLs, xlabel = &quot;θU&quot;, ylabel = &quot;LL&quot;, leg=false, grid=false)</code></pre></details><p>To overcome limitations of common MCMC samplers, we will use parallel tempering with the package <code>Pigeons.jl</code>.  In the code block below, we pass the Turing model with the tuple of data to the function <code>pigeons</code>. Because the GQEM is highly multimodal, we increase the number of chains  from the default of 10 to 20. </p><pre><code class="language-julia hljs"># Estimate parameters
pt = pigeons(
    target = TuringLogPotential(model(data)), 
    record = [traces], 
    multithreaded = true, 
    n_chains = 20,
)</code></pre><pre><code class="language-julia hljs">chains = Chains(pt)</code></pre><p>The output below shows the mean, standard deviation, effective sample size, and rhat for each of the five parameters. The panel below shows the quantiles of the marginal distributions. </p><pre><code class="language-julia hljs">Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   ess_per_sec 
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64       Missing 

          θG   -0.0883    1.9003    0.1310   209.2796   495.0300    1.0026       missing
          θU   -0.0527    1.5713    0.0858   404.8390   543.2327    0.9994       missing
         θψO    0.1158    1.6601    0.1256   188.7431   617.9621    1.0053       missing
         θψR   -0.0568    1.6559    0.1124   230.9679   527.2334    1.0123       missing
         θψU   -0.2296    1.5712    0.1082   171.3612   587.1192    1.0227       missing

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5% 
      Symbol   Float64   Float64   Float64   Float64   Float64 

          θG   -3.0715   -0.1495   -0.0539    0.1420    3.0691
          θU   -1.6493   -1.5724   -1.4849    1.5704    1.6413
         θψO   -2.4354   -0.7697    0.7051    0.7974    2.4393
         θψR   -2.3437   -0.8994   -0.7815    0.8831    2.3380
         θψU   -1.9365   -1.8452   -1.2235    1.2722    1.9279</code></pre><h2 id="Posterior-Distributions"><a class="docs-heading-anchor" href="#Posterior-Distributions">Posterior Distributions</a><a id="Posterior-Distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Posterior-Distributions" title="Permalink"></a></h2><h3 id="Mariginal-Posterior-Distributions"><a class="docs-heading-anchor" href="#Mariginal-Posterior-Distributions">Mariginal Posterior Distributions</a><a id="Mariginal-Posterior-Distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Mariginal-Posterior-Distributions" title="Permalink"></a></h3><p>The marginal posterior distributions below are highly multimodal, as expected.</p><pre><code class="language-julia hljs">plot(chains, grid = false)</code></pre><p><img src="../assets/posterior_distributions.png" alt/></p><h3 id="Corner-Plots"><a class="docs-heading-anchor" href="#Corner-Plots">Corner Plots</a><a id="Corner-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Corner-Plots" title="Permalink"></a></h3><p>Below, we will use corner plots to assess the ability of <code>Pigeons</code> to recover the data generating parameters. The corner plots are arranged as a matrix such that the subplot in row i and column j is the join posterior distribution of parameter i and parameter j. The blue horizontal and vertical lines represent the true, data-generating parameter values. For each parameter pair, the blue lines intersect on one of the modes, indicating the parameters were correctly recovered. </p><pre><code class="language-julia hljs">pairplot(chains, PairPlots.Truth(parms))</code></pre><p><img src="../assets/pairplots.png" alt/></p><h3 id="Posterior-Predictive-Distributions"><a class="docs-heading-anchor" href="#Posterior-Predictive-Distributions">Posterior Predictive Distributions</a><a id="Posterior-Predictive-Distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Posterior-Predictive-Distributions" title="Permalink"></a></h3><p>Finally, we will evaluate the descriptive adequacy of the GQEM by comparing the posterior predictive distributions to the generated data. The first step is to create a new Turing model to generate predictions from the posterior distribution. In the code block below, we asign the Turing model to the keyword <code>model</code>, we assign a function to that normalizes the predictions to keyword <code>func</code>, and set the number of samples to the number of trials per condition.</p><pre><code class="language-julia hljs">pred_model =
    predict_distribution(GQEM; model = model(data), func = x -&gt; x ./ n_trials, n_samples = n_trials)</code></pre><p>The next step is to sample from the posterior predictive distribution. The output is a matrix of matrices, where each submatrix is a prediction for each condition. </p><pre><code class="language-julia hljs">post_preds = generated_quantities(pred_model, chains)</code></pre><p>In the code block below, we plot the posterior predictive distribution for each condition and plot the generated data as a black, vertical line. In all cases, the distributions are centered near the data, indicating the model can reproduce the pattern observed in the data.</p><pre><code class="language-julia hljs">plot_predictions(post_preds, responses, n_trials)</code></pre><p><img src="../assets/posterior_predictive_distribution.png" alt/></p><h1 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h1><p>Trueblood, J. S., &amp; Hemmer, P. (2017). The generalized quantum episodic memory model. Cognitive Science, 41(8), 2089-2125.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../model_description/">« Model Description</a><a class="docs-footer-nextpage" href="../model_comparison/">Model Comparison »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Thursday 30 October 2025 07:21">Thursday 30 October 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
